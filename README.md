# Segmentation Service
–°–µ—Ä–≤–∏—Å, —Ö—Ä–∞–Ω—è—â–∏–π –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–µ–≥–º–µ–Ω—Ç—ã, –∫ –∫–æ—Ç–æ—Ä—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è. –°–µ—Ä–≤–∏—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

---

## **–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞** 
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å **API-—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏**, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏—Ç:

‚úÖ –ü—Ä–æ–≤–æ–¥–∏—Ç—å A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–∫–∏–¥–∫–∏, GPT –≤ –ø–æ—á—Ç–µ)

‚úÖ –ì–∏–±–∫–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º –≥—Ä—É–ø–ø–∞–º

‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–∞—Ö

## **–ó–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞**

#### *1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏*
- **–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `MAIL_GPT`, `CLOUD_DISCOUNT_30`)
- **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞** (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è)
- **–£–¥–∞–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞** (—Å –æ—á–∏—Å—Ç–∫–æ–π —Å–≤—è–∑–µ–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏)

#### *2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π*
- **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–µ–≥–º–µ–Ω—Ç**
- **–£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–∞**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ %** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `MAIL_GPT` –¥–ª—è 30% –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

#### *3. Backend, Frontend –∏ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö*
- **Backend** (FastAPI):
    - `database.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SQLite (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
    - `main.py` - REST API —Å 15+ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏
    - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

- **Frontend** (Streamlit):
    - 4 —Ä–∞–∑–¥–µ–ª–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API

- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
    - –¢–∞–±–ª–∏—Ü–∞ *Users (id, name, email)* - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
    - –¢–∞–±–ª–∏—Ü–∞ *Segments (id, segment, description)* - —Å–µ–≥–º–µ–Ω—Ç—ã
    - –¢–∞–±–ª–∏—Ü–∞ *U_S (user_id, segment_id)* - —Å–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º

*–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å API*:
  - `POST /segments` ‚Äì —Å–æ–∑–¥–∞—Ç—å —Å–µ–≥–º–µ–Ω—Ç
  - `POST /segments/move_users` - –ø–µ—Ä–µ–Ω–æ—Å –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏
  - `POST /segments/{name}/distribute` ‚Äì —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç –Ω–∞ % –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - `GET /users/{id}/segments` ‚Äì –ø–æ–ª—É—á–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## **–≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
| 01.07.2025 | –ò–∑—É—á–µ–Ω–∏–µ –¢–ó –ø—Ä–æ–µ–∫—Ç–∞, –ø–æ–¥–±–æ—Ä —Å—Ç–µ–∫–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π |
| 02.05.2025 | –ò–∑—É—á–µ–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–±–æ—Ç–µ —Å SQLite |
| 03.07.2025 | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ database.py |
| 04.07.2025 | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ main.py |
| 05.07.2025 | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ |
| 06.07.2025 | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ streamlit_app.py. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ|
| 07.07.2025 | –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Git –∏ –≤ –û–±–ª–∞–∫–æ Mail |

---

![–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è](https://github.com/user-attachments/assets/d442f149-3f8b-45bd-a9cd-a99d4189b53d)

---

## **–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã**
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î: `python database.py`
2. –ó–∞–ø—É—Å–∫ API: `python -m uvicorn main:app`
3. –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: `streamlit run streamlit_app.py`

---

## **–ü–æ—á–µ–º—É —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è VK?**  
üîπ **–ì–∏–±–∫–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** ‚Äì –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø  
üîπ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è A/B-—Ç–µ—Å—Ç–æ–≤** ‚Äì —Ä–∞–Ω–¥–æ–º–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
üîπ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äì –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –∫–æ–¥–∞  
üîπ **–ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫** ‚Äì —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–∞—Ö  

---

## **–î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ**
- *–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π* (–∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–µ–≥–º–µ–Ω—Ç)
- *–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞* (—É–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤)
- *–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö* (CSV/JSON –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏)

---

## **–ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**  
1. *–°–æ–∑–¥–∞–µ–º —Å–µ–≥–º–µ–Ω—Ç* `MAIL_GPT`  
2. *–†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞ 30% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π* (`POST /segments/MAIL_GPT/distribute`)  
3. *–ß–µ—Ä–µ–∑ –º–µ—Å—è—Ü –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º*:  
   - –°–∫–æ–ª—å–∫–æ –ø–∏—Å–µ–º —Å GPT –Ω–∞–ø–∏—Å–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–∞?  
   - –í—ã—Ä–æ—Å–ª–∞ –ª–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–æ–π?  

---

### **–í—ã–≤–æ–¥**  
–ü—Ä–æ–µ–∫—Ç –ø–æ–º–æ–∂–µ—Ç VK **—É–ø—Ä–∞–≤–ª—è—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏** —Å –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏, **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –∏ **—Å–æ–±–∏—Ä–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É** –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π.  
